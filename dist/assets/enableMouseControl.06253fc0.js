import{a_ as u,bA as E,bB as T,bC as n,bD as L,bv as k,bE as f}from"./index.ca3d1873.js";function w(){this.done||(this.createEffect(()=>{if(u()!==this.camera||!this.mouseControlState.get())return;if(E()===this.camera){const t=c=>this.gyrate(c.movementX,c.movementY);return document.addEventListener("mousemove",t),()=>{document.removeEventListener("mousemove",t)}}let o=!1,e,i,r;const s=()=>{o=!0,[i,r]=[void 0,void 0]},v=()=>o=!1,h=t=>{i===void 0&&(i=t.clientX),r===void 0&&(r=t.clientY);const[c,a]=[t.clientX-i,t.clientY-r];[i,r]=[t.clientX,t.clientY],o&&this.gyrate(c/window.innerWidth*3e3,a/window.innerHeight*3e3)};if(T){const t=d=>{e===void 0&&(e=d.changedTouches[d.changedTouches.length-1].identifier,s())};n.addEventListener("touchstart",t);const c=d=>{e!==void 0&&d.changedTouches[d.changedTouches.length-1].identifier===e&&(e=void 0,v())};n.addEventListener("touchend",c);const a=d=>{if(e===void 0)return;let l;for(let m=0;m<d.changedTouches.length;++m){const g=d.changedTouches[m];if(g.identifier===e){l=g;break}}l&&h(l)};return n.addEventListener("touchmove",a),()=>{n.removeEventListener("touchstart",t),n.removeEventListener("touchend",c),n.removeEventListener("touchmove",a),e=void 0,o=!1}}const C=L.on("down",s),b=L.on("up",v);return n.addEventListener("mousemove",h),()=>{C.cancel(),b.cancel(),n.removeEventListener("mousemove",h),e=void 0,o=!1}},[this.mouseControlState.get,u,E]),this.createEffect(()=>{const o=u();if(this.mouseControlState.get()!==!0||o!==this.camera||k())return;const e=()=>{var r,s;return(s=(r=n).requestPointerLock)==null?void 0:s.call(r)},i=()=>{document.pointerLockElement===n?f(o):f(void 0)};return n.addEventListener("click",e),document.addEventListener("pointerlockchange",i),()=>{n.removeEventListener("click",e),document.removeEventListener("pointerlockchange",i),document.exitPointerLock(),f(void 0)}},[this.mouseControlState.get,u,k]))}export{w as default};
