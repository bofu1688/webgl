import{av as g,aw as y,ax as l,ay as v,az as a,aA as p,aB as R,aC as b}from"./index.ca3d1873.js";import{g as u}from"./useBVHMap.950ec098.js";const C=new Set,[m,T]=g();y(function(){const r=u();if(!r.length){const e=l(m);return()=>{e.cancel()}}const f=l(()=>{m();for(const e of C){e.updateMatrixWorld();const i=v(e),{start:t,end:d}=p;d.copy(t.copy(e.position)),a.makeEmpty(),a.expandByPoint(t),a.min.addScalar(-.5),a.max.addScalar(.5);const h=R,x=b;let o=0,s=0;for(const S of r)S.shapecast({intersectsBounds:c=>c.intersectsBox(a),intersectsTriangle:c=>{o=c.closestPointToSegment(p,h,x),o<.5&&(s=.5-o,t.addScaledVector(i,s),d.addScaledVector(i,s))}});const n=t.sub(e.position),B=Math.max(0,n.length()-1e-5);n.normalize().multiplyScalar(B),e.position.add(n)}});return()=>{f.cancel()}},[u]);export{C as bvhCameraSet,m as emitBeforeCameraLoop,T as onBeforeCameraLoop};
